#!/bin/bash
# LLVMFuzzerTestOneInput for fuzzer detection.
this_dir=$(dirname "$0")
if [[ "$@" =~ (^| )-runs=[0-9]+($| ) ]]; then
  mem_settings='-Xmx1900m:-Xss900k'
else
  mem_settings='-Xmx2048m:-Xss1024k'
fi
LD_LIBRARY_PATH="/usr/lib/jvm/java-15-openjdk-amd64/lib/server":$this_dir $this_dir/jazzer_driver --agent_path=$this_dir/jazzer_agent_deploy.jar --cp=$this_dir/h2.jar::$this_dir --target_class=SqlPreparedStatementFuzzer --jvm_args="$mem_settings" --disabled_hooks="com.code_intelligence.jazzer.sanitizers.SqlInjection" $@
